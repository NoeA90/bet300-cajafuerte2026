<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>BET300 ¬∑ Caja Fuerte</title>
  <meta name="theme-color" content="#071018"/>

  <!--
    ‚úÖ LOGO (SVG) RECOMENDADO
    - Formato: SVG (ideal)
    - Alto ideal: 44‚Äì56px (se adapta solo)
    - Archivo: coloc√° tu logo navide√±o como:  /logo-navidad.svg
    - Fondo transparente
  -->

  <style>
    :root{
      --bg:#060b14;
      --bg2:#050818;
      --panel:#0b1224;
      --panel2:#081024;
      --border:#1c2a45;
      --text:#f4f7ff;
      --muted:#a8b3d8;

      /* Navidad pro (rojo + dorado + hielo) */
      --red:#ff2d3d;
      --red2:#d90f1f;
      --gold:#f6c453;
      --gold2:#ffd98a;
      --ice:#38d6ff;

      --ok:#25D366;
      --shadow: 0 18px 55px rgba(0,0,0,.55);
      --soft: rgba(255,255,255,.06);
      --soft2: rgba(255,255,255,.10);
      --ring: rgba(56,214,255,.25);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font: 15px/1.35 system-ui,-apple-system,Segoe UI,Roboto,Arial;
      color:var(--text);
      background:
        radial-gradient(950px 520px at 50% -12%, rgba(255,45,61,.18), transparent 62%),
        radial-gradient(760px 420px at 0% 0%, rgba(56,214,255,.16), transparent 55%),
        radial-gradient(680px 380px at 100% 10%, rgba(246,196,83,.12), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg) 65%);
      overflow-x:hidden;
      -webkit-tap-highlight-color: transparent;
    }

    /* nieve suave (se mantiene en Android) */
    .snow{position:fixed; inset:0; pointer-events:none; z-index:0;}
    .snow i{
      position:absolute; top:-14px;
      width:6px; height:6px; border-radius:50%;
      background:rgba(255,255,255,.90);
      opacity:.7;
      filter: blur(.4px);
      animation: fall linear infinite;
    }
    @keyframes fall{
      0%{ transform:translate3d(0,-14px,0); opacity:0 }
      10%{opacity:.75}
      100%{ transform:translate3d(var(--drift,18px), 110vh,0); opacity:0 }
    }

    .container{
      position:relative;
      z-index:1;
      max-width: 980px;
      margin: 0 auto;
      padding: 10px 12px 120px;
    }

    .card{
      background:
        radial-gradient(120% 100% at 50% 0%, rgba(56,214,255,.09), transparent 65%),
        radial-gradient(120% 100% at 50% 0%, rgba(246,196,83,.06), transparent 65%),
        var(--panel2);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 12px;
      box-shadow: var(--shadow);
    }

    /* HEADER compacto (1 l√≠nea en mobile) */
    .topbar{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 6px 6px 10px;
      flex-wrap:nowrap;
    }

    .brand{
      display:flex; align-items:center; gap:10px;
      min-width:0;
      flex: 1;
    }
    .brand img{
      height:52px; width:auto; display:block;
      filter: drop-shadow(0 6px 16px rgba(0,0,0,.55));
    }
    .brand .sub{
      font-size:12px;
      color:var(--gold2);
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
      white-space:nowrap;
    }

    .meta{
      display:flex; align-items:center; gap:8px;
      flex: 0 0 auto;
    }

    .pill{
      display:inline-flex; align-items:center; gap:8px;
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
      border: 1px solid var(--border);
      background: linear-gradient(90deg, rgba(255,45,61,.12), rgba(56,214,255,.10));
      color:var(--muted);
      white-space:nowrap;
    }
    .count{
      display:inline-flex; align-items:center;
      padding:3px 8px;
      border-radius:999px;
      border:1px solid rgba(246,196,83,.35);
      background: rgba(246,196,83,.12);
      color: var(--gold2);
      font-weight:900;
      font-variant-numeric: tabular-nums;
    }
    .sound{cursor:pointer; user-select:none}
    .sound b{color:var(--text)}

    @media(max-width:520px){
      .container{padding:0 0 120px}
      .card{border-radius:0;border-left:0;border-right:0}
      .topbar{padding:8px 8px 10px}
      .brand img{height:58px} /* logo m√°s grande en mobile */
      .brand .sub{display:none} /* reduce scroll; queda en hero */
      .pill{padding:7px 9px}
    }

    /* GRID */
    .grid{
      display:grid;
      gap:10px;
      grid-template-columns: minmax(0,1fr);
    }
    @media(min-width:900px){
      .grid{grid-template-columns: 1.1fr .9fr}
    }

    .panel{
      background: rgba(7,12,24,.6);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 12px;
      position:relative;
      overflow:hidden;
    }

    .hero{
      display:grid;
      gap:8px;
      padding: 10px 10px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.06);
      background:
        radial-gradient(140% 120% at 10% 0%, rgba(255,45,61,.16), transparent 55%),
        radial-gradient(140% 120% at 90% 0%, rgba(56,214,255,.12), transparent 55%),
        rgba(2,6,23,.25);
    }

    .hero h1{
      margin:0;
      font-size:18px;
      letter-spacing:.2px;
    }
    .hero p{
      margin:0;
      font-size:13px;
      color:var(--muted);
    }
    .hero .tagline{
      font-size:12px;
      color: var(--gold2);
      font-weight:900;
      letter-spacing:.18em;
      text-transform:uppercase;
    }

    /* CAJA FUERTE */
    .safeWrap{
      display:grid;
      gap:10px;
      align-items:center;
      justify-items:center;
      padding: 8px 6px 10px;
    }

    .safe{
      width:min(560px, 100%);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.06);
      background:
        linear-gradient(180deg, rgba(255,45,61,.10), rgba(0,0,0,0) 52%),
        linear-gradient(180deg, rgba(56,214,255,.06), rgba(0,0,0,0) 60%),
        rgba(8,16,36,.55);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04), 0 18px 40px rgba(0,0,0,.45);
      padding: 12px;
      position:relative;
      overflow:hidden;
    }

    .safe::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(520px 240px at 50% -20%, rgba(246,196,83,.18), transparent 65%),
        radial-gradient(420px 220px at 0% 30%, rgba(56,214,255,.12), transparent 60%),
        radial-gradient(420px 220px at 100% 60%, rgba(255,45,61,.10), transparent 60%);
      pointer-events:none;
      z-index:0;
    }

    .safeTop{
      position:relative;
      z-index:1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:10px;
      flex-wrap:wrap;
    }
    .safeTop .left{
      display:flex; gap:10px; align-items:center;
    }
    .shield{
      width:38px;height:38px;border-radius:12px;
      display:grid; place-items:center;
      background: radial-gradient(100% 100% at 50% 0%, rgba(56,214,255,.25), rgba(255,45,61,.18));
      border:1px solid rgba(255,255,255,.08);
      box-shadow: 0 12px 22px rgba(0,0,0,.4), inset 0 0 0 1px rgba(255,255,255,.04);
      font-size:18px;
    }
    .safeTop .title{
      display:grid; gap:2px;
      min-width:0;
    }
    .safeTop .title b{font-size:14px}
    .safeTop .title span{font-size:12px;color:var(--muted)}
    .tries{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(2,6,23,.35);
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }
    .dots{display:inline-flex;gap:6px;align-items:center}
    .dot{
      width:10px;height:10px;border-radius:999px;
      background:rgba(255,255,255,.14);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:0 0 0 4px rgba(56,214,255,.0);
    }
    .dot.on{
      background: rgba(246,196,83,.85);
      border-color: rgba(246,196,83,.5);
      box-shadow:0 0 0 4px rgba(246,196,83,.12);
    }

    /* display del c√≥digo */
    .dialRow{
      position:relative;
      z-index:1;
      display:grid;
      grid-template-columns:1fr 1fr 1fr;
      gap:10px;
      margin-top:6px;
      margin-bottom:10px;
    }

    .dial{
      border-radius:16px;
      border:1px solid rgba(255,255,255,.08);
      background:
        radial-gradient(120% 120% at 50% 0%, rgba(255,255,255,.08), rgba(255,255,255,.02)),
        rgba(2,6,23,.35);
      padding:10px;
      display:grid;
      gap:10px;
      justify-items:center;
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }

    .dial .num{
      width:100%;
      height:56px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.25);
      display:grid;place-items:center;
      font-size:26px;
      font-weight:1000;
      letter-spacing:.12em;
      color:var(--text);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03);
      user-select:none;
      position:relative;
      overflow:hidden;
    }
    .dial .num::after{
      content:"";
      position:absolute; inset:0;
      background: linear-gradient(90deg, transparent, rgba(56,214,255,.10), transparent);
      transform: translateX(-120%);
      animation: shine 3.2s ease-in-out infinite;
      opacity:.8;
    }
    @keyframes shine{ 0%{transform:translateX(-120%)} 55%{transform:translateX(120%)} 100%{transform:translateX(120%)} }

    .dialBtns{
      width:100%;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:8px;
    }
    .miniBtn{
      appearance:none;border:none;cursor:pointer;
      padding:10px 10px;
      border-radius:12px;
      font-weight:900;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      color:var(--text);
      transition: transform .06s ease, filter .12s ease, border-color .12s ease;
      touch-action: manipulation;
    }
    .miniBtn:active{transform:scale(.98)}
    .miniBtn:hover{filter:brightness(1.06); border-color: rgba(255,255,255,.18)}
    .miniBtn.up{background: linear-gradient(180deg, rgba(56,214,255,.16), rgba(255,255,255,.04))}
    .miniBtn.down{background: linear-gradient(180deg, rgba(255,45,61,.16), rgba(255,255,255,.04))}

    /* feedback tipo mastermind */
    .feedback{
      position:relative;
      z-index:1;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      flex-wrap:wrap;
      border-radius:14px;
      border:1px dashed rgba(255,255,255,.12);
      background: rgba(2,6,23,.30);
      padding:10px 10px;
    }
    .fbLeft{
      display:flex; gap:10px; align-items:center; flex-wrap:wrap;
      color:var(--muted); font-size:12px;
    }
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      font-weight:900;
      color:var(--text);
    }
    .chip .k{color:var(--muted); font-weight:800}
    .chip.good{border-color: rgba(246,196,83,.35); background: rgba(246,196,83,.10)}
    .chip.ice{border-color: rgba(56,214,255,.35); background: rgba(56,214,255,.10)}
    .chip.red{border-color: rgba(255,45,61,.35); background: rgba(255,45,61,.10)}
    .fbMsg{color:var(--muted); font-size:12px; max-width: 52ch}

    /* botones grandes */
    .actions{
      display:flex;
      gap:10px;
      width:min(560px, 100%);
      flex-wrap:wrap;
    }
    .btn{
      flex:1;
      appearance:none;border:none;cursor:pointer;
      padding:13px 14px;
      border-radius:16px;
      font-weight:1000;
      letter-spacing:.2px;
      color:#081024;
      box-shadow: 0 12px 28px rgba(0,0,0,.35);
      transition: transform .06s ease, filter .12s ease;
      touch-action: manipulation;
    }
    .btn:active{transform:scale(.99)}
    .btn:disabled{opacity:.55; cursor:not-allowed; filter:saturate(.6)}
    .btn.primary{
      background: linear-gradient(90deg, var(--red), #ff5966);
    }
    .btn.secondary{
      background: linear-gradient(90deg, var(--gold), var(--gold2));
    }
    .btn.ghost{
      background: transparent;
      color: var(--text);
      border:1px solid rgba(255,255,255,.12);
      box-shadow:none;
    }

    .divider{
      height:1px;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.10), transparent);
      margin: 10px 0;
    }

    /* panel derecho */
    .stat{
      display:flex; gap:12px; align-items:center; justify-content:center;
      margin: 6px 0 10px;
      flex-wrap:wrap;
    }
    .badge{
      min-width:74px;
      height:48px;
      border-radius:14px;
      display:grid; place-items:center;
      font-weight:1000;
      font-size:18px;
      color: var(--text);
      border: 1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(100% 100% at 50% 0%, rgba(56,214,255,.22), rgba(255,45,61,.14)),
        rgba(2,6,23,.25);
      box-shadow: inset 0 0 12px rgba(56,214,255,.10);
    }
    .smallline{
      font-size:12px;
      color: var(--muted);
      text-align:center;
    }

    .note{
      font-size:12px;
      color: var(--muted);
      border-radius:14px;
      border:1px dashed rgba(255,255,255,.12);
      background: rgba(2,6,23,.22);
      padding:10px;
    }

    /* lista de premios */
    .prizes{
      margin-top:10px;
      display:grid;
      gap:8px;
    }
    .prizes h3{
      margin:0;
      font-size:13px;
      color:var(--muted);
    }
    .plist{
      display:grid;
      gap:6px;
      list-style:none;
      padding:0;
      margin:0;
    }
    .plist li{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      padding:8px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(255,255,255,.03);
      font-size:12px;
      color:var(--muted);
    }
    .plist b{color:var(--text)}
    .tag{
      padding:3px 8px;
      border-radius:999px;
      font-weight:900;
      border:1px solid rgba(255,255,255,.10);
      color: var(--text);
      white-space:nowrap;
    }
    .tag.g{background:rgba(246,196,83,.12); border-color:rgba(246,196,83,.35); color:var(--gold2)}
    .tag.i{background:rgba(56,214,255,.12); border-color:rgba(56,214,255,.35); color:#bfefff}
    .tag.r{background:rgba(255,45,61,.12); border-color:rgba(255,45,61,.35); color:#ffd0d4}

    /* dock inferior (botones finales) */
    .dock{
      position:fixed; left:0; right:0; bottom:0; z-index:50;
      background: linear-gradient(180deg, rgba(6,11,20,0) 0%, rgba(6,11,20,.82) 22%, rgba(6,11,20,.95) 100%);
      padding:10px 12px 12px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0;
      display:none;
      align-items:center; justify-content:center;
      background: rgba(0,0,0,.62);
      backdrop-filter: blur(6px);
      z-index:80;
    }
    .modal.show{display:flex}
    .modalCard{
      width:min(540px, 92vw);
      border-radius:18px;
      border:1px solid rgba(255,255,255,.10);
      background:
        radial-gradient(900px 420px at 50% -20%, rgba(246,196,83,.14), transparent 65%),
        radial-gradient(900px 420px at 10% 0%, rgba(56,214,255,.12), transparent 60%),
        rgba(8,16,36,.92);
      box-shadow: 0 22px 60px rgba(0,0,0,.6);
      padding:14px;
      position:relative;
    }
    .modalHead{
      display:flex; align-items:center; gap:10px;
      margin-bottom:10px;
    }
    .modalHead img{height:42px;width:auto;display:block}
    .modalHead .x{
      margin-left:auto;
      cursor:pointer;
      opacity:.85;
      font-weight:900;
      padding:6px 10px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
    }
    .modalHead .x:hover{opacity:1}
    .modalBody{display:grid; gap:10px}
    .row{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px dashed rgba(255,255,255,.14);
      background: rgba(2,6,23,.25);
      font-size:13px;
      color:var(--muted);
    }
    .row b{color:var(--text)}
    .modalActions{display:flex; gap:10px; flex-wrap:wrap; margin-top:4px}

    /* Animaci√≥n de ‚Äúunlock‚Äù */
    .pulse{
      animation: pulse 1.2s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{filter:drop-shadow(0 0 0 rgba(56,214,255,.0))}
      50%{filter:drop-shadow(0 0 18px rgba(56,214,255,.22))}
    }

    /* Android UX */
    button, .miniBtn, .btn { -webkit-user-select:none; user-select:none; }
    input { font-size:16px; } /* evita zoom en iOS/Android */
  </style>
</head>

<body>
  <div class="snow" id="snow" aria-hidden="true"></div>

  <!-- MODAL PREMIO -->
  <div id="modal" class="modal" role="dialog" aria-modal="true" aria-labelledby="mTitle">
    <div class="modalCard">
      <div class="modalHead">
        <img id="mLogo" src="logo-navidad.svg" alt="Logo" onerror="this.style.display='none'">
        <div>
          <div id="mTitle" style="font-weight:1000">üéÅ Premio asignado</div>
          <div style="font-size:12px;color:var(--muted)">Guardalo para reclamar</div>
        </div>
        <div class="x" id="mX">‚úñ</div>
      </div>
      <div class="modalBody">
        <div class="row"><span>Premio</span><b id="mPrize">‚Äî</b></div>
        <div class="row"><span>C√≥digo</span><b id="mCode">‚Äî</b></div>
        <div class="row"><span>Fecha/Hora</span><b id="mTs">‚Äî</b></div>
        <div class="modalActions">
          <button id="mClaim" class="btn primary">üì≤ Reclamar por WhatsApp</button>
          <a id="mEnter" class="btn secondary" href="#" target="_blank" rel="noopener" style="text-decoration:none;display:inline-grid;place-items:center;">üéÆ Entrar a la plataforma</a>
          <button id="mClose" class="btn ghost">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="card">
      <!-- HEADER (compacto) -->
      <div class="topbar">
        <div class="brand">
          <img id="topLogo" src="logo-navidad.svg" alt="Logo" onerror="this.style.display='none'">
          <div class="sub">ESPECIAL NAVIDAD</div>
        </div>

        <div class="meta">
          <span class="pill time">‚è±Ô∏è <span class="count" id="countdown">--:--</span></span>
          <span class="pill sound" id="soundToggle">üîä <b id="soundState">ON</b></span>
        </div>
      </div>

      <div class="grid">
        <!-- IZQUIERDA: juego -->
        <div class="panel">
          <div class="hero">
            <div class="tagline">Especial Navidad</div>
            <h1>üîê Caja Fuerte ¬∑ Crack the code</h1>
            <p>
              Ten√©s <b>3 intentos</b> para abrirla. Si abr√≠s: premio mayor.
              Si no abr√≠s: <b>premio garantizado</b> (20% o $3.000).
            </p>
          </div>

          <div class="safeWrap">
            <div class="safe" id="safeBox">
              <div class="safeTop">
                <div class="left">
                  <div class="shield" id="shield">üõ°Ô∏è</div>
                  <div class="title">
                    <b id="safeTitle">Ingres√° el c√≥digo</b>
                    <span id="safeSub">Ajust√° los 3 d√≠gitos y prob√° suerte (con l√≥gica üòâ)</span>
                  </div>
                </div>

                <div class="tries">
                  <span>Intentos</span>
                  <span class="dots" id="dots"></span>
                </div>
              </div>

              <div class="dialRow">
                <div class="dial">
                  <div class="num" id="n1">0</div>
                  <div class="dialBtns">
                    <button class="miniBtn up"   id="u1" type="button">‚ñ≤</button>
                    <button class="miniBtn down" id="d1" type="button">‚ñº</button>
                  </div>
                </div>

                <div class="dial">
                  <div class="num" id="n2">0</div>
                  <div class="dialBtns">
                    <button class="miniBtn up"   id="u2" type="button">‚ñ≤</button>
                    <button class="miniBtn down" id="d2" type="button">‚ñº</button>
                  </div>
                </div>

                <div class="dial">
                  <div class="num" id="n3">0</div>
                  <div class="dialBtns">
                    <button class="miniBtn up"   id="u3" type="button">‚ñ≤</button>
                    <button class="miniBtn down" id="d3" type="button">‚ñº</button>
                  </div>
                </div>
              </div>

              <div class="feedback">
                <div class="fbLeft">
                  <span class="chip good"><span class="k">‚úÖ Exactos</span> <b id="exact">0</b></span>
                  <span class="chip ice"><span class="k">üü° Presentes</span> <b id="present">0</b></span>
                  <span class="chip red"><span class="k">üéØ Intento</span> <b id="tryNo">1/3</b></span>
                </div>
                <div class="fbMsg" id="fbMsg">Tip: ‚ÄúExactos‚Äù = n√∫mero y posici√≥n correcta.</div>
              </div>

              <div class="divider"></div>

              <div class="actions">
                <button class="btn primary" id="tryBtn" type="button">üîì Probar c√≥digo</button>
                <button class="btn ghost" id="resetBtn" type="button">‚Ü∫ Reiniciar d√≠gitos</button>
              </div>
            </div>

            <div class="actions">
              <a class="btn secondary" id="enterBtn" href="https://bet300.biz" target="_blank" rel="noopener" style="text-decoration:none;display:inline-grid;place-items:center;">üéÆ Entrar a la plataforma</a>
              <button class="btn ghost" id="againBtn" type="button">üîÅ Intentar de nuevo</button>
            </div>

            <div class="note" id="dailyNote">
              ‚õî <b>1 vez por d√≠a</b> por dispositivo. Si ya jugaste hoy, te va a avisar.
            </div>
          </div>
        </div>

        <!-- DERECHA: info + premios -->
        <div class="panel">
          <div class="stat">
            <div>
              <div class="badge" id="badge">‚Äî</div>
              <div class="smallline" id="stamp">C√≥digo: ‚Äî</div>
            </div>
            <div style="max-width:40ch">
              <div style="font-weight:1000;font-size:16px" id="rTitle">Ten√©s 1 juego disponible</div>
              <div class="smallline" id="rSub">Abr√≠ la caja para desbloquear tu beneficio.</div>
            </div>
          </div>

          <div class="note" id="ruleBox">
            <b>C√≥mo se gana:</b><br/>
            ‚Ä¢ Abr√≠s si consegu√≠s <b>3 exactos</b> (los 3 n√∫meros en su lugar).<br/>
            ‚Ä¢ Si no abr√≠s en 3 intentos: <b>premio garantizado</b> (20% o $3.000).
          </div>

          <div class="prizes">
            <h3>üéÅ Posibles premios</h3>
            <ul class="plist" id="prizeList">
              <li><span><b>Premio mayor</b> (si abr√≠s r√°pido)</span><span class="tag g">50% / $10.000</span></li>
              <li><span><b>Premio medio</b></span><span class="tag i">40% / $5.000</span></li>
              <li><span><b>Premio menor</b> (si abr√≠s al 3er intento)</span><span class="tag r">30% / $4.000</span></li>
              <li><span><b>Garantizado</b> (si no abr√≠s)</span><span class="tag g">20% o $3.000</span></li>
            </ul>
          </div>

          <div class="divider"></div>

          <div class="note">
            ‚úÖ Recomendaci√≥n: avisale al operador el <b>c√≥digo</b> que te aparece.<br/>
            Si quer√©s, tambi√©n pod√©s entrar directo a la plataforma.
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- DOCK: cuando ya hay premio -->
  <div class="dock">
    <button id="claimBtn" class="btn primary" disabled>üì≤ Reclamar por WhatsApp</button>
    <a id="dockEnter" class="btn secondary" href="https://bet300.biz" target="_blank" rel="noopener" style="text-decoration:none;display:inline-grid;place-items:center;">üéÆ Entrar a la plataforma</a>
  </div>

<script>
/* ===========================================================
  CAJA FUERTE ¬∑ Crack the code (3 intentos, 1 vez por d√≠a)
  - Profesional, mobile-first (Android OK)
  - Antifraude local: device_id + fecha + pc + SALT
  - 5 par√°metros: ?pc=1|2|3|4|5 (para WhatsApp/operador)
=========================================================== */

/* ========= Config ========= */
const PLATFORM_LINK = "https://bet300.biz";

/* WhatsApp gen√©ricos (despu√©s los reemplaz√°s por reales) */
const WP_NUMBERS = {
  pc1: "5491100000001",
  pc2: "5491100000002",
  pc3: "5491100000003",
  pc4: "5491100000004",
  pc5: "5491100000005",
};

function normalizeWP(n){
  const s = String(n||"").replace(/[^\d+]/g,"");
  if(s.startsWith("+549")) return s.slice(1);
  if(s.startsWith("549"))  return s;
  if(s.startsWith("+54"))  return "549"+s.slice(3);
  if(s.startsWith("54"))   return "549"+s.slice(2);
  return "549"+s;
}

/* pc=1..5 */
const params = new URLSearchParams(location.search);
const pcParam = (params.get("pc")||"1").trim();
const pc = /^[1-5]$/.test(pcParam) ? pcParam : "1";
const pcKey = "pc"+pc;
const WP = normalizeWP(WP_NUMBERS[pcKey]);

/* enlaces */
document.getElementById("enterBtn").href = PLATFORM_LINK;
document.getElementById("dockEnter").href = PLATFORM_LINK;
document.getElementById("mEnter").href = PLATFORM_LINK;

/* ========= Antifraude ========= */
const SALT = "bet300-safe-v1";
function ensureDeviceId(){
  let id = localStorage.getItem("device_id");
  if(!id){
    id = (crypto.randomUUID?.() || `${Date.now()}-${Math.random().toString(36).slice(2,10)}`);
    localStorage.setItem("device_id", id);
  }
  return id;
}
const DEVICE_ID = ensureDeviceId();

function todayKey(){
  const n=new Date();
  return `${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`;
}
function tsString(d=new Date()){
  const dd=String(d.getDate()).padStart(2,'0'),mm=String(d.getMonth()+1).padStart(2,'0'),yyyy=d.getFullYear();
  const hh=String(d.getHours()).padStart(2,'0'),mi=String(d.getMinutes()).padStart(2,'0');
  return `${dd}/${mm}/${yyyy} ${hh}:${mi}`;
}
async function sha256hex(msg){
  const enc = new TextEncoder().encode(msg);
  const buf = await crypto.subtle.digest("SHA-256", enc);
  return Array.from(new Uint8Array(buf)).map(b=>b.toString(16).padStart(2,"0")).join("");
}
async function makeClaimCode(prizeLabel){
  const base = `${DEVICE_ID}|${todayKey()}|${prizeLabel}|pc:${pc}|${SALT}`;
  const hex = await sha256hex(base);
  return hex.slice(0,10).toUpperCase();
}

/* ========= Secreto del d√≠a (estable) =========
   No es ‚Äúinseguro‚Äù (sin servidor), pero evita refresh abuse.
*/
async function dailySecret(){
  const base = `${DEVICE_ID}|${todayKey()}|pc:${pc}|secret|${SALT}`;
  const hex = await sha256hex(base);
  // tomar 3 d√≠gitos 0-9 de forma determin√≠stica
  const a = parseInt(hex.slice(0,2),16)%10;
  const b = parseInt(hex.slice(2,4),16)%10;
  const c = parseInt(hex.slice(4,6),16)%10;
  return [a,b,c];
}

/* ========= UI refs ========= */
const n1=document.getElementById("n1"), n2=document.getElementById("n2"), n3=document.getElementById("n3");
const exactEl=document.getElementById("exact");
const presentEl=document.getElementById("present");
const tryNoEl=document.getElementById("tryNo");
const fbMsg=document.getElementById("fbMsg");
const dots=document.getElementById("dots");

const tryBtn=document.getElementById("tryBtn");
const resetBtn=document.getElementById("resetBtn");
const againBtn=document.getElementById("againBtn");

const badge=document.getElementById("badge");
const stamp=document.getElementById("stamp");
const rTitle=document.getElementById("rTitle");
const rSub=document.getElementById("rSub");
const shield=document.getElementById("shield");
const safeTitle=document.getElementById("safeTitle");
const safeSub=document.getElementById("safeSub");

const claimBtn=document.getElementById("claimBtn");

/* Modal */
const modal=document.getElementById("modal");
const mPrize=document.getElementById("mPrize");
const mCode=document.getElementById("mCode");
const mTs=document.getElementById("mTs");
const mClaim=document.getElementById("mClaim");
const mClose=document.getElementById("mClose");
const mX=document.getElementById("mX");

/* ========= Sonido (suave) ========= */
let soundOn=true;
const soundToggle=document.getElementById("soundToggle");
const soundState=document.getElementById("soundState");
const AudioKit=(()=>{
  const Ctx=window.AudioContext||window.webkitAudioContext;
  const ctx=new Ctx(); let unlocked=false;
  function unlock(){ if(!unlocked){ ctx.resume().catch(()=>{}); unlocked=true; } }
  function blip(freq=740,dur=0.05,vol=0.05,type='triangle'){
    const o=ctx.createOscillator(); const g=ctx.createGain();
    o.type=type; o.frequency.value=freq; g.gain.value=0;
    o.connect(g).connect(ctx.destination);
    const t=ctx.currentTime;
    g.gain.linearRampToValueAtTime(vol,t+0.008);
    g.gain.exponentialRampToValueAtTime(0.0001,t+dur);
    o.start(t); o.stop(t+dur);
  }
  function ok(){ [820,1040,1320].forEach((f,i)=>setTimeout(()=>blip(f,0.10,0.07,'sine'), i*120)); }
  function no(){ blip(280,0.08,0.06,'square'); setTimeout(()=>blip(220,0.08,0.05,'square'),90); }
  function click(){ blip(620,0.04,0.03,'triangle'); }
  return {unlock,ok,no,click};
})();
document.addEventListener('click',()=>AudioKit.unlock(),{once:true});
soundToggle.addEventListener("click",()=>{
  soundOn=!soundOn;
  soundState.textContent=soundOn?"ON":"OFF";
});

/* ========= Helpers ========= */
function money(n){ return "$"+Number(n).toLocaleString("es-AR"); }

/* Premio (label + tipo) */
function prizeLabel(p){
  if(p.type==="percent") return `${p.value}%`;
  if(p.type==="money") return money(p.value);
  if(p.type==="double") return `Doble carga`;
  return String(p.value||"‚Äî");
}

/* WhatsApp text */
function whatsappText(pLabel, code, ts){
  return `Hola, obtuve *${pLabel}* en la *Caja Fuerte BET300* üîê\n`+
         `C√≥digo: *${code}* ¬∑ ${ts}\n`+
         `¬øMe aplican el beneficio con mi pr√≥xima carga?`;
}

/* ========= Juego ========= */
const MAX_TRIES = 3;

let secret = [0,0,0];
let guess  = [0,0,0];
let triesUsed = 0;
let locked = false;

/* storage keys por pc */
const KEY_PREFIX = `safe_${pcKey}_`;
const K_DATE = KEY_PREFIX+"date";
const K_DONE = KEY_PREFIX+"done";
const K_PRIZE= KEY_PREFIX+"prize";
const K_CODE = KEY_PREFIX+"code";
const K_TS   = KEY_PREFIX+"ts";

/* Dots UI */
function paintDots(){
  dots.innerHTML="";
  for(let i=0;i<MAX_TRIES;i++){
    const d=document.createElement("span");
    d.className="dot"+(i<triesUsed?" on":"");
    dots.appendChild(d);
  }
}

/* Actualiza display num */
function syncNums(){
  n1.textContent=guess[0];
  n2.textContent=guess[1];
  n3.textContent=guess[2];
}

/* Reset UI feedback */
function resetFeedback(){
  exactEl.textContent="0";
  presentEl.textContent="0";
  tryNoEl.textContent=`${Math.min(triesUsed+1,MAX_TRIES)}/${MAX_TRIES}`;
  fbMsg.textContent="Tip: ‚ÄúPresentes‚Äù = est√° en el c√≥digo pero en otra posici√≥n.";
}

/* Increment/decrement (0..9 circular) */
function step(i,delta){
  if(locked) return;
  guess[i] = (guess[i] + delta + 10) % 10;
  syncNums();
  if(soundOn) AudioKit.click();
}

/* Attach buttons */
document.getElementById("u1").onclick=()=>step(0,+1);
document.getElementById("d1").onclick=()=>step(0,-1);
document.getElementById("u2").onclick=()=>step(1,+1);
document.getElementById("d2").onclick=()=>step(1,-1);
document.getElementById("u3").onclick=()=>step(2,+1);
document.getElementById("d3").onclick=()=>step(2,-1);

resetBtn.onclick=()=>{
  if(locked) return;
  guess=[0,0,0];
  syncNums();
  resetFeedback();
};

/* ========= Evaluaci√≥n (exactos/presentes correcto con repetidos) ========= */
function evaluate(secretArr, guessArr){
  let exact=0;

  const sLeft=[], gLeft=[];
  for(let i=0;i<3;i++){
    if(secretArr[i]===guessArr[i]) exact++;
    else{
      sLeft.push(secretArr[i]);
      gLeft.push(guessArr[i]);
    }
  }
  // present = intersecci√≥n con conteo (bolsa)
  const counts = new Map();
  sLeft.forEach(x=>counts.set(x,(counts.get(x)||0)+1));
  let present=0;
  gLeft.forEach(x=>{
    const c=counts.get(x)||0;
    if(c>0){ present++; counts.set(x,c-1); }
  });

  return {exact, present};
}

/* ========= Premios =========
   - Si abre (exact=3): premio seg√∫n intento (m√°s r√°pido = mejor)
   - Si no abre: garantizado 20% o $3.000
   - (Opcional) pod√©s agregar "double" en el mejor premio si quer√©s
*/
function rollPrize(opened, attemptNo){
  if(opened){
    // attemptNo: 1..3
    if(attemptNo===1){
      // premio mayor (50% o 10k o doble)
      const r=Math.random();
      if(r<0.40) return {type:"percent", value:50};
      if(r<0.85) return {type:"money", value:10000};
      return {type:"double", value:"double"};
    }
    if(attemptNo===2){
      const r=Math.random();
      if(r<0.50) return {type:"percent", value:40};
      return {type:"money", value:5000};
    }
    // attempt 3
    const r=Math.random();
    if(r<0.55) return {type:"percent", value:30};
    return {type:"money", value:4000};
  }else{
    // garantizado: 50/50
    return (Math.random()<0.5) ? {type:"percent", value:20} : {type:"money", value:3000};
  }
}

/* ========= Persistencia diaria ========= */
function restoreDaily(){
  const today=todayKey();
  const stored=localStorage.getItem(K_DATE);
  if(stored && stored!==today){
    localStorage.removeItem(K_DONE);
    localStorage.removeItem(K_PRIZE);
    localStorage.removeItem(K_CODE);
    localStorage.removeItem(K_TS);
    localStorage.setItem(K_DATE, today);
  }else if(!stored){
    localStorage.setItem(K_DATE, today);
  }
}

/* Mostrar premio guardado si existe */
function restoreIfPlayed(){
  const done = localStorage.getItem(K_DONE)==="1";
  const saved = localStorage.getItem(K_PRIZE);
  if(done && saved){
    const p = JSON.parse(saved);
    const code = localStorage.getItem(K_CODE) || "‚Äî";
    const ts = localStorage.getItem(K_TS) || tsString();

    applyPrizeUI(p, code, ts, true);
    lockGameUI();
  }else{
    // limpio UI
    badge.textContent="‚Äî";
    stamp.textContent="C√≥digo: ‚Äî";
    rTitle.textContent="Ten√©s 1 juego disponible";
    rSub.textContent="Abr√≠ la caja para desbloquear tu beneficio.";
    claimBtn.disabled=true;
  }
}

/* ========= Lock / Unlock UI ========= */
function lockGameUI(){
  locked = true;
  tryBtn.disabled = true;
  resetBtn.disabled = true;
  shield.textContent="üîí";
  safeTitle.textContent="Juego utilizado";
  safeSub.textContent="Volv√© ma√±ana para un nuevo intento.";
}
function unlockGameUI(){
  locked = false;
  triesUsed = 0;
  paintDots();
  resetFeedback();
  tryBtn.disabled = false;
  resetBtn.disabled = false;
  shield.textContent="üõ°Ô∏è";
  safeTitle.textContent="Ingres√° el c√≥digo";
  safeSub.textContent="Ajust√° los 3 d√≠gitos y prob√° suerte (con l√≥gica üòâ)";
}

/* Bot√≥n ‚ÄúIntentar de nuevo‚Äù (si ya us√≥ la chance) */
againBtn.onclick=()=>{
  if(localStorage.getItem(K_DONE)==="1"){
    alert("Ya usaste tu chance de hoy. Volv√© ma√±ana üôå");
    return;
  }
  alert("Todav√≠a ten√©s tu chance de hoy. Prob√° el c√≥digo üòâ");
};

/* ========= Modal ========= */
function openModal(pLabel, code, ts){
  mPrize.textContent = pLabel;
  mCode.textContent  = code;
  mTs.textContent    = ts;

  // link WA con texto
  const msg = whatsappText(pLabel, code, ts);
  mClaim.onclick = ()=>location.href = `https://wa.me/${WP}?text=${encodeURIComponent(msg)}`;

  modal.classList.add("show");
}
function closeModal(){ modal.classList.remove("show"); }
mClose.onclick=closeModal;
mX.onclick=closeModal;
modal.addEventListener("click",(e)=>{ if(e.target===modal) closeModal(); });

/* ========= UI Premio ========= */
function applyPrizeUI(p, code, ts, persisted=false){
  const pLabel = prizeLabel(p);

  badge.textContent = (p.type==="money") ? money(p.value)
                   : (p.type==="percent") ? `${p.value}%`
                   : "x2";

  stamp.textContent = `C√≥digo: ${code} ¬∑ ${ts}`;

  rTitle.textContent = "üéâ ¬°Beneficio asignado!";
  rSub.innerHTML = (p.type==="money")
    ? `Recib√≠s <b>${money(p.value)} extra</b> con tu pr√≥xima carga.`
    : (p.type==="percent")
      ? `Recib√≠s un <b>${p.value}% extra</b> con tu pr√≥xima carga.`
      : `Recib√≠s <b>Doble de tu carga</b> (seg√∫n tope del operador).`;

  // habilitar reclamar (dock)
  const msg = whatsappText(pLabel, code, ts);
  claimBtn.disabled=false;
  claimBtn.onclick = ()=>location.href = `https://wa.me/${WP}?text=${encodeURIComponent(msg)}`;

  // abrir modal si reci√©n asign√≥
  if(!persisted){
    setTimeout(()=>openModal(pLabel, code, ts), 250);
  }
}

/* ========= Intentos ========= */
tryBtn.onclick = async ()=>{
  if(locked) return;

  // si ya jug√≥ hoy
  if(localStorage.getItem(K_DONE)==="1"){
    alert("Ya usaste tu chance de hoy. Volv√© ma√±ana üôå");
    lockGameUI();
    return;
  }

  triesUsed++;
  paintDots();

  const res = evaluate(secret, guess);
  exactEl.textContent = String(res.exact);
  presentEl.textContent = String(res.present);
  tryNoEl.textContent = `${Math.min(triesUsed,MAX_TRIES)}/${MAX_TRIES}`;

  // feedback texto pro
  if(res.exact===3){
    fbMsg.textContent = "‚úÖ ¬°Abriste la caja! Premio mayor asignado.";
  }else if(res.exact===2){
    fbMsg.textContent = "üî• Muy cerca: 2 exactos. Ajust√° el que falta.";
  }else if(res.exact===1 && res.present>=1){
    fbMsg.textContent = "üëç Ten√©s 1 exacto y al menos 1 presente. Reorden√°.";
  }else if(res.present>=2){
    fbMsg.textContent = "üß† Bien: hay n√∫meros correctos pero est√°n desordenados.";
  }else{
    fbMsg.textContent = "‚ùÑÔ∏è Pista: prob√° cambiar m√°s de un d√≠gito.";
  }

  if(soundOn){
    if(res.exact===3) AudioKit.ok();
    else AudioKit.no();
  }

  // Si abre -> asignar premio inmediato
  if(res.exact===3){
    await finishGame(true, triesUsed);
    return;
  }

  // Si lleg√≥ al intento 3 sin abrir -> premio garantizado
  if(triesUsed>=MAX_TRIES){
    await finishGame(false, triesUsed);
    return;
  }
};

async function finishGame(opened, attemptNo){
  // asignar premio
  const p = rollPrize(opened, attemptNo);
  const pLabel = prizeLabel(p);
  const code = await makeClaimCode(pLabel);
  const ts = tsString(new Date());

  // persistir
  localStorage.setItem(K_DONE,"1");
  localStorage.setItem(K_PRIZE, JSON.stringify(p));
  localStorage.setItem(K_CODE, code);
  localStorage.setItem(K_TS, ts);
  localStorage.setItem(K_DATE, todayKey());

  // UI
  applyPrizeUI(p, code, ts, false);
  lockGameUI();

  // ‚Äúefecto‚Äù visual leve
  const safeBox = document.getElementById("safeBox");
  safeBox.classList.add("pulse");
  setTimeout(()=>safeBox.classList.remove("pulse"), 1400);

  // si no abri√≥, aclaraci√≥n
  if(!opened){
    fbMsg.textContent = "üéÅ No se abri√≥, pero igual ten√©s premio garantizado.";
  }
}

/* ========= Countdown ========= */
function endOfDay(){
  const n=new Date();
  const end=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,0,0).getTime();
  return end>Date.now()?end:new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,23,59,0,0).getTime();
}
function tickCountdown(){
  const ms=endOfDay()-Date.now();
  const total=Math.max(0,Math.floor(ms/1000));
  const h=Math.floor(total/3600), m=Math.floor((total%3600)/60), s=total%60;
  const txt = h>0 ? `${h}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`
                  : `${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  document.getElementById("countdown").textContent = txt;
}

/* ========= Snow ========= */
function setupSnow(){
  const snow=document.getElementById("snow");
  snow.innerHTML="";
  const flakes = 44;
  for(let i=0;i<flakes;i++){
    const f=document.createElement("i");
    const size = 2.5 + Math.random()*4.2;
    f.style.width=f.style.height=size+"px";
    f.style.left=(Math.random()*100)+"vw";
    f.style.opacity=(0.45+Math.random()*0.5).toFixed(2);
    f.style.animationDuration=(7+Math.random()*7).toFixed(2)+"s";
    f.style.animationDelay=(Math.random()*-10).toFixed(2)+"s";
    f.style.setProperty("--drift", ((Math.random()*46)-23).toFixed(0)+"px");
    snow.appendChild(f);
  }
}

/* ========= Init ========= */
async function init(){
  setupSnow();
  restoreDaily();

  // secreto del d√≠a
  secret = await dailySecret();

  // init UI
  guess=[0,0,0];
  syncNums();
  triesUsed=0;
  paintDots();
  resetFeedback();

  // restore si ya jug√≥
  restoreIfPlayed();
  if(localStorage.getItem(K_DONE)!=="1"){
    unlockGameUI();
  }

  // countdown
  tickCountdown();
  setInterval(tickCountdown, 1000);
}
init();
</script>
</body>
</html>
